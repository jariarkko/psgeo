<!DOCTYPE html>
<html>
<head>
	<title>Activity map</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8">
        <meta permission-policy: geolocation=(self)>
        <link rel="stylesheet" href="css/style.css">
</head>
<body>
	<div id="map"></div>

	<script src="./lib/psgeo.js"></script>
	<script src="./lib/psgeotables.js"></script>
	<script src="./lib/psgeosettings.js"></script>
	<script src="./lib/psgeolocation.js"></script>
	<script src="./lib/psgeodb.js"></script>
	<script src="./lib/psgeodbbackend.js"></script>
	<script src="./lib/psgeodbtext.js"></script>
	<script src="./lib/psgeolang.js"></script>
	<script src="./lib/psgeoschema.js"></script>
	<script src="./lib/psgeolib.js"></script>
	<script src="./lib/psgeostat.js"></script>
	<!-- Dynamically load Google Maps java script API in finnish or english based on ?lang=XX -->
	<script>
                const apiKey = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";

                // Define a proxy for URLSearchParams with a simplified get
                // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy
                // https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
                const params = new Proxy(new URLSearchParams(window.location.search), {
                                   get: (searchParams, prop) => searchParams.get(prop),
                                   });
                let uiLanguage = params.lang;

		const fileref=document.createElement('script');
		fileref.setAttribute("type","text/javascript");
		fileref.setAttribute("async","true");
		fileref.setAttribute("defer","true");
                fileref.setAttribute("src","https://maps.googleapis.com/maps/api/js?key="+apiKey+"&language="+uiLanguage+"&callback=psgeoInit" ); 

		document.getElementsByTagName("head")[0].appendChild(fileref);
	</script>
    </body>
</html>

