<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">

<rfc ipr='trust200902' docName="draft-arkko-activity-json-00" category="info">

  <?rfc toc="yes"?>
  <?rfc symrefs="yes"?>
  <?rfc autobreaks="yes"?>
  <?rfc tocindent="yes"?>
  <?rfc compact="yes"?>
  <?rfc subcompact="no"?>

  <front>

    <title abbrev="Activity JSON">Activity JSON</title>

    <author initials="J" surname="Arkko" fullname="Jari Arkko">
      <organization>Planetskier</organization>
      <address>
        <postal>
          <street>Välitie 1B</street>
          <city>Kauniainen</city> <code>02700</code>
          <country>Finland</country>
        </postal>
        <email>jari@arkko.com</email>
      </address>
    </author>


    <date month="May" year="2020" />

    <keyword>JSON</keyword>
    <keyword>Activity</keyword>
    <keyword>GeoJSON</keyword>

    <abstract>

      <t>Activity JSON is a simple format that allows providing
      information about activities and their geographic positions.  It
      is an extension of existing formats, specialized to provide some
      additional information that applications can use to perform
      filtering, showing useful information to the user, and so
      on. Activity JSON is primarily targeted towards passing
      information between a web server and an application running in a
      browser.</t>
      
    </abstract>

  </front>

  <middle>

    <section title="Introduction">

      <t>The author has worked with web applications that deal with
      sports activities in different locations. The applications allow
      displaying varying activities on a map, smart filtering based
      on specific type or attributes of those activities.</t>

      <t>Activity JSON is a simple format that allows providing
      information about activities and their geographic positions.  It
      is an extension of existing formats, specialized to provide some
      additional information that applications can use to perform
      filtering, showing useful information to the user, and so
      on. Activity JSON is primarily targeted towards passing
      information between a web server and an application running in a
      browser.</t>

      <t>JavaScript Object Notation (JSON) <xref target="RFC7159"/> is
      a popular format used in web applications. GeoJSON <xref
      target="RFC7946"/> <xref target="GeoJSON"/> is a format for
      encoding a variety of geographic data structures using JSON.</t>

      <t>Activity JSON has been used in building websites for
      skiing-related activities reported in <xref
      target="Planetskier"/> and caving-related activities reported in
      <xref target="Luolaseura"/> and <xref
      target="Planetcaver"/>.</t>

      <t>The rest of this document is organized as follows. <xref
      target="goals"/> discusses the goals for this work, and <xref
      target="modelling"/> covers some of the modelling issues. <xref
      target="gen2"/> describes the currently specified format for
      Activity JSON. The description includes specification of the
      syntax rules and the structure as inherited from base
      specifications, and a detailed discussion of the specific
      properties that can be described by Activity JSON objects.</t>

      <t>There are, however, two older versions of Activity JSON.
      Software libraries support all format variants, so using an
      older format is generally ok, but for new information the
      Generation 2 format is RECOMMENDED.  Note that with Generation 2
      format, Activity JSON can be directly supplied to a wide variety
      of software that accepts GeoJSON. The earlier format generations
      and compatibility discussion can be found in <xref
      target="gen1"/>, <xref target="gen0"/>, and <xref
      target="compat"/>.</t>
      
    </section>

    <section title="Normative Language">
      
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
      "MAY", and "OPTIONAL" in this document are to be interpreted as
      described in BCP 14 <xref target="RFC2119"/> <xref
      target="RFC8174"/> when, and only when, they appear in all
      capitals, as shown here.</t>
      
    </section>

    <section anchor="goals" title="Goals">

      <t>There are many tools and formats to manipulate, collect,
      store, and display collections of points or other geographic
      objects. Formats for information relating to this (such as <xref
      target="RFC7946"/> or <xref target="KML"/>) are prior art and
      not something that needs to be replicated.</t>
      
    </section>
    
    <section anchor="modelling" title="Modelling Activities">

      <t>...</t>
      
    </section>
    
    <section anchor="gen2" title="Generation 2 Format">

      <t>The format is a specialization of GeoJSON. Every Activity
      JSON object is also a valid GeoJSON object, but has some extra
      properties to carry the information that is needed to describe
      the activities.</t>

      <t>For example, an empty file contains just:</t>
      
      <figure>
        <artwork>
          {
            "type": "FeatureCollection",
            "features": []
          }
        </artwork>
      </figure>
      
      <t>Here's an example of a file with just one entry:</t>

      <figure>
        <artwork>
  {
    "type": "FeatureCollection",
    "features": [
        {
          "type":
             "Feature",
          "geometry":
             { "type": "Point",
               "coordinates": [60.30145486, 24.62792567] },
          "properties": {
            "n": "Kattilajärven iso lippaluola, Nuuksio, Espoo",
            "m": "https://example.com/cavemap-kattilajarvi.pdf",
            "l": 9.3,
            "la": "exact",
            "k": "Espoo",
            "c": "Finland",
            "o": "Europe",
            "rl": [{ "t": "Kattilajärvi roof caves",
                     "i": "https://example.com/a-picture.jpg"
                     "w": ["Jari"],
                     "y": 2020,
                     "m": 5,
                     "a": ["Caving"],
                     "sa": ["Rock"],
                     "u": "https://example.com/an-article.html" }
                  ]
           }
        }
    ]
  }
        </artwork>
      </figure>

      <section anchor="prop" title="Properties">

      <t>The properties described in a GeoJSON file are as follows:
      
      <list style="hanging">

        <t hangText="n"><vspace blankLines="1"/>
        The name of the place. By convention the last item of the name
        (after last comma) should be city name. Mandatory.</t>
        
        <t hangText="lat, lon"><vspace blankLines="1"/>
        The coordinates, in WGS84 format. Mandatory.</t>
        
        <t hangText="alt"><vspace blankLines="1"/>
        An optional attribute that describes the altitude the location
        or the highest point in the destination, in memeters.</t>
        
        <t hangText="fz"><vspace blankLines="1"/>
        Set to true if the coordinates are "fuzzy" to hide the true
        location for privacy etc. reasons. Default is false. This
        attribute is optional.</t>
        
        <t hangText="m"><vspace blankLines="1"/>
        The cave map link URL, if any. If there's no URL, the
        attribute should not be specified at all (and should not be
        set to, e.g., empty string, although it is recommended that
        software recognises empty strings similarly to missing
        attributes.</t>
        
        <t hangText="l"><vspace blankLines="1"/>
        The length of the cave in meters, if known. The attribute is
        optional, and should be left out if no value is known.</t>
        
        <t hangText="la"><vspace blankLines="1"/>
        The cave length accuracy ("exact" or "approx"). The attribute
        is optional, and the default value is "approx" if no other
        value is provided.</t>
        
        <t hangText="k"><vspace blankLines="1"/>
        The city/town/county. This attribute is mandatory.</t>
        
        <t hangText="c"><vspace blankLines="1"/>
        The country. This attribute is mandatory.</t>
        
        <t hangText="o"><vspace blankLines="1"/>
        The continent. This attribute is mandatory.</t>
        
        <t hangText="rl"><vspace blankLines="1"/> The "reading list",
        a list of articles describing visits etc. This can of course
        be empty, i.e., [], but the attribute itself is mandatory. The
        description of what an article object is can be found from
        <xref target="article"/>.</t>
        
      </list></t>

    </section>

    <section anchor="article" title="Article Objects">
    
      <t>Aach article is a JSON record. The record has the following fields:
      
      <list style="hanging">

        <t hangText="t"><vspace blankLines="1"/>
        The title. This attribute is mandatory.</t>
        
        <t hangText="i"><vspace blankLines="1"/>
        URL for an image representing the article. This attribute is
        optional. If no image URL known, the attribute should not be
        specified at all.</t>
        
        <t hangText="w"><vspace blankLines="1"/>
        List of people who were there. This attribute is
        mandatory.</t>
        
        <t hangText="y"><vspace blankLines="1"/>
        Year of visit (as a number). This attribute is mandatory.</t>
        
        <t hangText="m"><vspace blankLines="1"/>
        The month of visit (as a number, between 1-12). This attribute
        is mandatory.</t>
        
        <t hangText="a"><vspace blankLines="1"/>
        The activity: Caving, Skiing, etc. This attribute is mandatory.</t>

        <t hangText="sa"><vspace blankLines="1"/>
        The sub-activity, e.g., within caving the allowed
        sub-activities or cave types are Rock, Ice, Man-made, Science,
        and Equipment and within skiing they are Outdoor, Indoor,
        Snow, Sand, Rock, Ash, Asphalt, Grass, Mud, Plastic,
        Other-substances, and Imported-snow. This attribute is
        mandatory.</t>
        
        <t hangText="u"><vspace blankLines="1"/>
        URL for the article. This attribute is optional. If no URL is
        known, the attribute should not be specified at all.</t>

      </list></t>

      </section>

    </section>
    
    <section anchor="gen1" title="Generation 1 Format">
      
      <t>The format is based on JSON. An Activity JSON Generation 1
      object MUST be a JSON array of records. </t>
      
      <t>For example, an empty file contains just:</t>
      
      <figure>
        <artwork>
          []
        </artwork>
      </figure>
      
      <t>Here's an example of a file with just one entry:</t>

      <figure>
        <artwork>
      [
       {"n": "Kattilajärven iso lippaluola, Nuuksio, Espoo",
        "lat": 60.30145486,
        "lon": 24.62792567,
        "m": "https://example.com/cavemap-kattilajarvi.pdf",
        "l": 9.3,
        "la": "exact",
        "k": "Espoo",
        "c": "Finland",
        "o": "Europe",
        "rl": [{ "t": "Kattilajärvi roof caves",
                 "i": "https://example.com/a-picture.jpg"
                 "w": ["Jari"],
                 "y": 2020,
                 "m": 5,
                 "a": ["Caving"],
                 "sa": ["Rock"],
                 "u": "https://example.com/an-article.html" }
              ]
       }
      ]
        </artwork>
      </figure>

      <t>Where the fields are as described in <xref target="prop"/>.</t>
      
    </section>
    
    <section anchor="gen0" title="Generation 0 Format">

      <t>Generation 0 format is similar to Generation 1 format, with the following differences:
      
      <list style="symbols">

      <t>The "k" (city) field was not used.</t>
      <t>The "y" (year) and "m" (month) fields were not used.</t>
      </list>
      </t>

   </section>

   <section anchor="compat" title="Compatibility">
   
      <t>All the formats are very similar. The information content is
      the same, and the attributes about the activities are
      represented literally in the same way. The only differences are
      some additional information in Generation 2 and Generation 1
      formats, and the wrapping of entries in the GeoJSON objects in
      Generation 2 format vs. simply containing them in a list in
      Generations 1 and 2 formats.</t>

      <t>The Psgeo software library supports both <xref
      target="Psgeo"/>, so existing files with content in Generation 1
      format continue to be readable. </t>

      <t>For compatibility between generation 1 and 0, the differences
      are again supported by software libraries and any Generation 0
      content continues to be acceptable by systems consuming Activity
      JSON.</t>
      
    </section>
    
  </middle>
  <back>

    <references title="Normative References">
      
      <?rfc include="reference.RFC.2119.xml"?>
      <?rfc include="reference.RFC.7159.xml"?>
      <?rfc include="reference.RFC.7946.xml"?>
      <?rfc include="reference.RFC.8174.xml"?>
      
    </references>

    <references title="Informative References">

      <reference anchor="KML">
        <front>
	  <title>OGC KML</title>
          <author initials="T" surname="Wilson"></author>
	  <date month="April" year="2008" />
        </front>
        <seriesInfo name="OGC 07-147r2" value="version 2.2.20" />
      </reference>

      <reference anchor="Psgeo">
        <front>
	  <title>Psgeo: Activity location library</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://github.com/jariarkko/psgeo" />
      </reference>

      <reference anchor="GeoJSON">
        <front>
	  <title>GeoJSON</title>
          <author><organization>GeoJSON</organization></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://geojson.org" />
      </reference>
      
      <reference anchor="Luolaseura">
        <front>
	  <title>Suomen Luolaseura</title>
          <author><organization>Luolaseura</organization></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://luolaseura.fi" />
      </reference>
      
      <reference anchor="Planetskier">
        <front>
	  <title>Skiing the Planet</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://planetskier.net" />
      </reference>
      
      <reference anchor="Planetcaver">
	<front>
	  <title>The Planetcaver</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
	</front>
	<seriesInfo name="website" value="https://planetcaver.net" />
      </reference>
      
    </references>
    
    <section title="Contributors">
      
      <t>The author would like to acknowledge the contributions of Ralf
      Strandell, Jarmo Ruuth, and Dare Talvitie. Discussions with you
      have greatly enhanced knowledge about this topic.</t>
      
    </section>
    
  </back>
  
</rfc>
