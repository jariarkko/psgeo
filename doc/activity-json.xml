<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">

<rfc ipr='trust200902' docName="draft-arkko-activity-json-00" category="info">

  <?rfc toc="yes"?>
  <?rfc symrefs="yes"?>
  <?rfc autobreaks="yes"?>
  <?rfc tocindent="yes"?>
  <?rfc compact="yes"?>
  <?rfc subcompact="no"?>

  <front>

    <title abbrev="Activity JSON">Activity JSON</title>

    <author initials="J" surname="Arkko" fullname="Jari Arkko">
      <organization>Planetskier</organization>
      <address>
        <postal>
          <street>Välitie 1B</street>
          <city>Kauniainen</city> <code>02700</code>
          <country>Finland</country>
        </postal>
        <email>jari@arkko.com</email>
      </address>
    </author>


    <date month="May" year="2020" />

    <keyword>JSON</keyword>
    <keyword>Activity</keyword>
    <keyword>GeoJSON</keyword>

    <abstract>

      <t>Activity JSON is a simple format that allows providing
      information about activities and their geographic positions.  It
      is an extension of existing formats, specialized to provide some
      additional information that applications can use to perform
      filtering, showing useful information to the user, and so
      on. Activity JSON is primarily targeted towards passing
      information between a web server and an application running in a
      browser.</t>
      
    </abstract>

  </front>

  <middle>

    <section title="Introduction">

      <t>The author has worked with web applications that deal with
      sports activities in different locations. The applications allow
      displaying varying activities on a map, smart filtering based
      on specific type or attributes of those activities.</t>

      <t>Activity JSON is a simple format that allows providing
      information about activities and their geographic positions.  It
      is an extension of existing formats, specialized to provide some
      additional information that applications can use to perform
      filtering, showing useful information to the user, and so
      on. Activity JSON is primarily targeted towards passing
      information between a web server and an application running in a
      browser.</t>

      <t>JavaScript Object Notation (JSON) <xref target="RFC7159"/> is
      a popular format used in web applications. GeoJSON <xref
      target="RFC7946"/> <xref target="GeoJSON"/> is a format for
      encoding a variety of geographic data structures using JSON.</t>

      <t>Activity JSON has been used in building websites for
      skiing-related activities reported in <xref
      target="Planetskier"/> and caving-related activities reported in
      <xref target="Luolaseura"/> and <xref
      target="Planetcaver"/>.</t>

      <t>The rest of this document is organized as follows. <xref
      target="goals"/> discusses the goals for this work, and <xref
      target="modelling"/> covers some of the modelling issues. <xref
      target="gen2"/> describes the currently specified format for
      Activity JSON. The description includes specification of the
      syntax rules and the structure as inherited from base
      specifications, and a detailed discussion of the specific
      properties that can be described by Activity JSON objects.</t>

      <t>There are, however, two older versions of Activity JSON.
      Software libraries support all format variants, so using an
      older format is generally ok, but for new information the
      Generation 2 format is RECOMMENDED.  Note that with Generation 2
      format, Activity JSON can be directly supplied to a wide variety
      of software that accepts GeoJSON. The earlier format generations
      and compatibility discussion can be found in <xref
      target="gen1"/>, <xref target="gen0"/>, and <xref
      target="compat"/>.</t>
      
    </section>

    <section title="Normative Language">
      
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
      "MAY", and "OPTIONAL" in this document are to be interpreted as
      described in BCP 14 <xref target="RFC2119"/> <xref
      target="RFC8174"/> when, and only when, they appear in all
      capitals, as shown here.</t>
      
    </section>

    <section anchor="goals" title="Goals">

      <t>There are many tools and formats to manipulate, collect,
      store, and display collections of points or other geographic
      objects. Formats for information relating to this (such as <xref
      target="RFC7946"/> or <xref target="KML"/>) are prior art and
      not something that needs to be replicated.</t>

      <t>However, what is not as easily available in these formats is
      all the additional metadata associated with the entries. Such
      metadata is essential for many functions, like searching,
      filtering, organizing information in various ways, sorting, and
      so on. Of course, any particularly application can use whatever
      metadata it prefers to, but for some categories of applications
      it may be preferrable to provide a common definition of what
      information is needed. This will facilitate interoperability
      across systems, and enable easier sharing of data.</t>

      <t>The goal of this document is to define such metadata in a
      concrete fashion as an extension of GeoJSON properties, for
      sports/nature exploration type activites, such as skiing or
      caving. Specifically, we wish to define a data format for
      applications sharing information about activities, their
      locations, and associated metadata.</t>
      
      <t>It should also be noted that defining a data format
      is just about defining a data format, and it is not a solution
      for all other problems. For instance, the following are outside
      the scope of the sharing data format and therefore
      non-goals for this effort:

      <list style="symbols">
        <t>Representing media about particular activities. This work
        takes the approach that all substantial information is merely
        a reference rather than the data itself.</t>
        <t>While this format is well suited for sharing information
        about
        detailed maps about the places of the activities -- such as
        ski area  maps or cave maps -- this happens again via
        references.
        Representing such complex maps themselves inside this format
        is not a goal, and the format does not have the expressive
        power for such specialized work. References are sufficient for
        our purposes.</t>
        <t>Databases -- how data is stored in servers and other
        systems is outside the scope of this work. Databases are often
        needed, but we take no position on how that happens, it is an
        internal matter to who ever is building the system in
        question.
        <vspace blankLines="1"/>
        One should note that database access mechanisms are often
        used to retrieve data, and as such, are an alternative to
        datasharing. However, we have found that binding to particular
        details of access via a database is often more complex than
        merely passing easily parsable JSON around. But there are of
        course situations where databases are necessary as well.
        The main goal of this work is to enable sharing in an
        easy, web-friendly manner, and support applications that might
        for instance fetch data from multiple sources.</t>
        <t>Access control to non-public information. This format is
        primarily designed for carrying information that is publicly
        available. It has support to hide some things -- such as the
        location of caves with restricted access -- but it is not a
        good vehicle for managing access for more information to specific authorized
        individuals. The format is best suited for bulk transfer of
        public data (with the occasional obfuscated location).</t>
        <t>Functionality of applications. What the various
        applications do with the information shared is outside the
        scope of this work.</t>
      </list></t>

      
    </section>
    
    <section anchor="modelling" title="Modelling Activities">

      <t>First off, there's a philosophical question of whether we are
      describing real-world entities or their exploration. We've
      chosen to model everything as visits or exploration, leaving
      some coordinates, descriptions, articles and maps as a record of
      the activity. But this still describes real-world entities such
      as ski slopes or caves accurately. The information is just that
      -- information. Whether an application or human decides to pay
      attention to who visited that place and when or just the
      characteristics of the place, is their choice.</t>

      <t>Nevertheless, we've chosen to structure the model around the
      locations, in line with GeoJSON. Each activity, report,
      participant list, cave map, etc. is hanging off the location,
      rather than being an independent entity that has
      locations. We've found this design to be most workable for
      software that attempts to display activities on a map.</t>
      
      <t>There is an interesting design trade-off between describing
      high-level entities vs. going all the way to the finest
      detail. As noted above, we have chosen to not attempt to model
      detailed maps of particular ski resort, for instance. That is
      something reserved for the ski resort itself. Nevertheless,
      sometimes it is useful to not just describe that a ski resort
      exists at a particular location, but also describe visits or
      activity that takes place at a special place in that ski resort,
      e.g., a mountain top.</t>

      <t>In great amounts, such additional information can become
      confusing, however. We've chosen to enable the model to show
      relationships, such as a mountaintop having a relation to the
      ski resort. Or a side peak having a relationship to the main
      peak of a mountain. This additional information can then be
      chosen to be used or displayed by software or ignored, depending
      on the needs of the application, the granularity of the map
      being shown, etc.</t>
      
      <t>The distinction between a main attraction and side ones is perhaps more relevant for caving.
      Where there are caves there are often several in a group, or
      small side caves accompany a larger cave. And even for a large
      cave itself, there may be multiple entrances. While Activity
      JSON does not attempt to describe the internal maps of the cave
      (except by reference), it can still describe the fact that there
      are side caves and multiple entrances. This information can be
      useful when looking at an area of caves in detail.</t>

      <t>In this version of the specification, the supported
      activities and their sub-activities are as follows:
      
      <list style="hanging">
        
        <t hangText="Biking"><vspace blankLines="1"/>
        The sub-activities are Road and Mountain.</t>
        
        <t hangText="Canoeing"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Caving"><vspace blankLines="1"/>
        The sub-activities are Rock, Ice, Man-made, Science, and Equipment.</t>
        
        <t hangText="Charity"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Climbing"><vspace blankLines="1"/>
        The sub-activities are Mountain, Rock, Ice, Wall, and Volcanoes.</t>
        
        <t hangText="Diving"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Equipment"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Hiking"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="History"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Sauna"><vspace blankLines="1"/>
        The sub-activities are Normal, Smoke, Steam.</t>
        
        <t hangText="Skiing"><vspace blankLines="1"/> The
        sub-activities are Outdoor, Indoor, Snow, Sand, Rock, Ash,
        Asphalt, Grass, Mud, Plastic, Other-substances, and
        Imported-snow.</t>
        
        <t hangText="Skydiving"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Sliding"><vspace blankLines="1"/>
        The sub-activities are the same as for Skiing.</t>
        
        <t hangText="Snowboarding"><vspace blankLines="1"/>
        The sub-activities are the same as for Skiing.</t>
        
        <t hangText="Surfing"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Swimming"><vspace blankLines="1"/>
        Indoor, Outdoor, Underground, Water, Ice.</t>
        
        <t hangText="Travel"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Urban-exploration"><vspace blankLines="1"/>
        The sub-activities are Tunnels, Buildings, Ruins, Bunkers,
        Quarries, Industrial, Silos, Ski-lifts, Landfills, Castles,
        Vehicles, Trenches, Memorial, Historic-sites, Bridges,
        Skating-rinks, Amusement-parks, Airports, Catacombs, Railways,
        Smokestacks, Towers, Prisons, Harbours, and Military.</t>
        
        <t hangText="Wakeboarding"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Walking"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Waterfalls"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
        <t hangText="Other"><vspace blankLines="1"/>
        There are no sub-activities.</t>
        
      </list></t>
      
    </section>
    
    <section anchor="gen2" title="Generation 2 Format">

      <t>The format is a specialization of GeoJSON. Every Activity
      JSON object is also a valid GeoJSON object, but has some extra
      properties to carry the information that is needed to describe
      the activities.</t>

      <t>For example, an empty file contains just:</t>
      
      <figure>
        <artwork>
          {
            "type": "FeatureCollection",
            "features": []
          }
        </artwork>
      </figure>
      
      <t>Here's an example of a file with just one entry:</t>

      <figure>
        <artwork>
  {
    "type": "FeatureCollection",
    "features": [
        {
          "type":
             "Feature",
          "geometry":
             { "type": "Point",
               "coordinates": [60.30145486, 24.62792567] },
          "properties": {
            "n": "Kattilajärven iso lippaluola, Nuuksio, Espoo",
            "m": "https://example.com/cavemap-kattilajarvi.pdf",
            "l": 9.3,
            "la": "exact",
            "k": "Espoo",
            "c": "Finland",
            "o": "Europe",
            "rl": [{ "t": "Kattilajärvi roof caves",
                     "i": "https://example.com/a-picture.jpg",
                     "w": ["Jari"],
                     "y": 2020,
                     "m": 5,
                     "a": ["Caving"],
                     "sa": ["Rock"],
                     "u": "https://example.com/an-article.html" }
                  ]
           }
        }
    ]
  }
        </artwork>
      </figure>

      <section anchor="usage" title="Features">
        
        <t>In this version of the specification, only features of the
        type "Point" are allowed.</t>
        
      </section>
      
      <section anchor="prop" title="Properties">

      <t>The properties described in a GeoJSON file are as follows:
      
      <list style="hanging">

        <t hangText="n"><vspace blankLines="1"/>
        The name of the place. By convention the last item of the name
        (after last comma) should be city name. Mandatory.</t>
        
        <t hangText="lat, lon"><vspace blankLines="1"/>
        The coordinates, in WGS84 format. Mandatory.</t>

        <t hangText="rn"><vspace blankLines="1"/>
        This optional attribute enables building relations between
        different items. The "rn" attribute identifies another entity
        in the same dataset that there is a special relationship to.
        The value of the "rn" attribute should be the name of the
        place where there's a relationship to, i.e., the value of the
        "n" attribute in some other item in the same dataset.
        The "rt" attribute provides the type of this relationship.</t>
        
        <t hangText="rt"><vspace blankLines="1"/>
        This optional attribute MUST be present when the "rn"
        attribute is present. The "rt" attribute describes the
        type of the relationship. Currently supported relationship
        types are:
        <list style="symbols">
          <t>"entrance": This entity is another entrance to the
          same cave as described in the entity referred to.</t>
          <t>"sidecave": This entity is another (side) cave of the
          main cave described in the entity referred to.</t>
          <t>"peak": This entity is a mountain peak, top lift, or
          other similar location in the entity referred to.</t>
          <t>"part": This entity is somehow otherwise part of the
          entity referred to.</t>
        </list></t>
        
        <t hangText="alt"><vspace blankLines="1"/>
        An optional attribute that describes the altitude the location
        or the highest point in the destination, in meters.</t>
        
        <t hangText="fz"><vspace blankLines="1"/>
        Set to true if the coordinates are "fuzzy" to hide the true
        location for privacy etc. reasons. Default is false. This
        attribute is optional.</t>
        
        <t hangText="m"><vspace blankLines="1"/>
        The cave map link URL, if any. If there's no URL, the
        attribute should not be specified at all (and should not be
        set to, e.g., empty string, although it is recommended that
        software recognises empty strings similarly to missing
        attributes.</t>
        
        <t hangText="l"><vspace blankLines="1"/>
        The length of the cave in meters, if known. The attribute is
        optional, and should be left out if no value is known.</t>
        
        <t hangText="h"><vspace blankLines="1"/>
        The height/vertical difference in the cave in meters, if known. The attribute is
        optional, and should be left out if no value is known.</t>
        
        <t hangText="la"><vspace blankLines="1"/>
        The cave length and height accuracy ("exact" or "approx"). The attribute
        is optional, and the default value is "approx" if no other
        value is provided.</t>
        
        <t hangText="k"><vspace blankLines="1"/>
        The city/town/county. In Finland the relevant "kunta" or
        community should be filled in. This attribute is mandatory.</t>
        
        <t hangText="c"><vspace blankLines="1"/>
        The country. This attribute is mandatory.</t>
        
        <t hangText="o"><vspace blankLines="1"/>
        The continent. This attribute is mandatory.</t>
        
        <t hangText="rl"><vspace blankLines="1"/> The "reading list",
        a list of articles describing visits etc. This can of course
        be empty, i.e., [], but the attribute itself is mandatory. The
        description of what an article object is can be found from
        <xref target="article"/>.</t>

        <t hangText="s"><vspace blankLines="1"/>The source of the
        data, if specified. The source is simply represented as a
        string.
        Note that the source often defaults from whereever the data is
        being fetched, so typically this does not need to be set
        unless somehow specifically different from other entries.</t>
        
      </list></t>

    </section>

    <section anchor="article" title="Article Objects">
    
      <t>Aach article is a JSON record. The record has the following fields:
      
      <list style="hanging">

        <t hangText="t"><vspace blankLines="1"/>
        The title. This attribute is mandatory.</t>
        
        <t hangText="i"><vspace blankLines="1"/>
        URL for an image representing the article. This attribute is
        optional. If no image URL known, the attribute should not be
        specified at all.</t>
        
        <t hangText="w"><vspace blankLines="1"/>
        List of people who were there. This attribute is
        mandatory.</t>
        
        <t hangText="y"><vspace blankLines="1"/>
        Year of visit (as a number). This attribute is mandatory.</t>
        
        <t hangText="m"><vspace blankLines="1"/>
        The month of visit (as a number, between 1-12). This attribute
        is mandatory.</t>
        
        <t hangText="a"><vspace blankLines="1"/>
        The activity: Caving, Skiing, etc. This attribute is mandatory.</t>

        <t hangText="sa"><vspace blankLines="1"/>
        The sub-activity, e.g., within caving the allowed
        sub-activities or cave types are Rock, Ice, Man-made, Science,
        and Equipment and within skiing they are Outdoor, Indoor,
        Snow, Sand, Rock, Ash, Asphalt, Grass, Mud, Plastic,
        Other-substances, and Imported-snow. This attribute is
        mandatory.</t>
        
        <t hangText="u"><vspace blankLines="1"/>
        URL for the article. This attribute is optional. If no URL is
        known, the attribute should not be specified at all.</t>

      </list></t>

      </section>

    </section>
    
    <section anchor="gen1" title="Generation 1 Format">
      
      <t>The format is based on JSON. An Activity JSON Generation 1
      object MUST be a JSON array of records. </t>
      
      <t>For example, an empty file contains just:</t>
      
      <figure>
        <artwork>
          []
        </artwork>
      </figure>
      
      <t>Here's an example of a file with just one entry:</t>

      <figure>
        <artwork>
      [
       {"n": "Kattilajärven iso lippaluola, Nuuksio, Espoo",
        "lat": 60.30145486,
        "lon": 24.62792567,
        "m": "https://example.com/cavemap-kattilajarvi.pdf",
        "l": 9.3,
        "la": "exact",
        "k": "Espoo",
        "c": "Finland",
        "o": "Europe",
        "rl": [{ "t": "Kattilajärvi roof caves",
                 "i": "https://example.com/a-picture.jpg",
                 "w": ["Jari"],
                 "y": 2020,
                 "m": 5,
                 "a": ["Caving"],
                 "sa": ["Rock"],
                 "u": "https://example.com/an-article.html" }
              ]
       }
      ]
        </artwork>
      </figure>

      <t>Where the fields are as described in <xref target="prop"/>.</t>
      
    </section>
    
    <section anchor="gen0" title="Generation 0 Format">

      <t>Generation 0 format is similar to Generation 1 format, with the following differences:
      
      <list style="symbols">

      <t>The "k" (city) field was not used.</t>
      <t>The "y" (year) and "m" (month) fields were not used.</t>
      </list>
      </t>

   </section>

   <section anchor="compat" title="Compatibility">
   
      <t>All the formats are very similar. The information content is
      the same, and the attributes about the activities are
      represented literally in the same way. The only differences are
      some additional information in Generation 2 and Generation 1
      formats, and the wrapping of entries in the GeoJSON objects in
      Generation 2 format vs. simply containing them in a list in
      Generations 1 and 2 formats.</t>

      <t>The Psgeo software library supports both <xref
      target="Psgeo"/>, so existing files with content in Generation 1
      format continue to be readable. </t>

      <t>For compatibility between generation 1 and 0, the differences
      are again supported by software libraries and any Generation 0
      content continues to be acceptable by systems consuming Activity
      JSON.</t>
      
    </section>
    
  </middle>
  <back>

    <references title="Normative References">
      
      <?rfc include="reference.RFC.2119.xml"?>
      <?rfc include="reference.RFC.7159.xml"?>
      <?rfc include="reference.RFC.7946.xml"?>
      <?rfc include="reference.RFC.8174.xml"?>
      
    </references>

    <references title="Informative References">

      <reference anchor="KML">
        <front>
	  <title>OGC KML</title>
          <author initials="T" surname="Wilson"></author>
	  <date month="April" year="2008" />
        </front>
        <seriesInfo name="OGC 07-147r2" value="version 2.2.20" />
      </reference>

      <reference anchor="Psgeo">
        <front>
	  <title>Psgeo: Activity location library</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://github.com/jariarkko/psgeo" />
      </reference>

      <reference anchor="GeoJSON">
        <front>
	  <title>GeoJSON</title>
          <author><organization>GeoJSON</organization></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://geojson.org" />
      </reference>
      
      <reference anchor="Luolaseura">
        <front>
	  <title>Suomen Luolaseura</title>
          <author><organization>Luolaseura</organization></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://luolaseura.fi" />
      </reference>
      
      <reference anchor="Planetskier">
        <front>
	  <title>Skiing the Planet</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
        </front>
        <seriesInfo name="website" value="https://planetskier.net" />
      </reference>
      
      <reference anchor="Planetcaver">
	<front>
	  <title>The Planetcaver</title>
          <author initials="J" surname="Arkko"></author>
	  <date month="May" year="2020" />
	</front>
	<seriesInfo name="website" value="https://planetcaver.net" />
      </reference>
      
    </references>
    
    <section title="Contributors">
      
      <t>The author would like to acknowledge the contributions of Ralf
      Strandell, Jarmo Ruuth, and Dare Talvitie. Discussions with you
      have greatly enhanced knowledge about this topic.</t>
      
    </section>
    
  </back>
  
</rfc>
